module.exports=[70406,(t,e,a)=>{e.exports=t.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},12967,t=>t.a(async(e,a)=>{try{let e=await t.y("axios");t.n(e),a()}catch(t){a(t)}},!0),18692,(t,e,a)=>{e.exports=t.x("geoip-lite",()=>require("geoip-lite"))},83950,t=>t.a(async(e,a)=>{try{var r=t.i(12967),n=t.i(18692),o=e([r]);[r]=o.then?(await o)():o;let u=["173.212.203.145","161.97.97.41","192.190.136.36","192.190.136.38","207.244.255.1","192.190.136.28","192.190.136.29"],c=new Map,h=t=>t?t.split("-")[0].replace(/[^0-9.]/g,""):"0.0.0",p=(t,e)=>{let a=h(t).split(".").map(Number),r=h(e).split(".").map(Number);for(let t=0;t<Math.max(a.length,r.length);t++){let e=a[t]||0,n=r[t]||0;if(e>n)return 1;if(e<n)return -1}return 0},y={timeout:8e3,headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"application/json, text/plain, */*"}};async function i(){let t={jsonrpc:"2.0",method:"get-pods-with-stats",params:[],id:1};try{let e=await r.default.post(`http://${u[0]}:6000/rpc`,t,{timeout:4e3});if(e.data?.result?.pods)return e.data.result.pods}catch(t){}let e=u.slice(1).sort(()=>.5-Math.random()).slice(0,3);try{return await Promise.any(e.map(e=>r.default.post(`http://${e}:6000/rpc`,t,{timeout:4e3}).then(t=>t.data?.result?.pods||[])))}catch(t){return[]}}async function s(){let[t,e]=await Promise.allSettled([r.default.get("https://podcredits.xandeum.network/api/mainnet-pod-credits",y),r.default.get("https://podcredits.xandeum.network/api/pods-credits",y)]),a=t=>{if("fulfilled"!==t.status)return[];let e=t.value.data;return e?.pods_credits&&Array.isArray(e.pods_credits)?e.pods_credits:Array.isArray(e)?e:[]};return{mainnet:a(t),devnet:a(e)}}async function l(t){let e=t.filter(t=>!c.has(t));if(e.length>0){try{for(let t=0;t<e.length;t+=100){let a=e.slice(t,t+100);(await r.default.post("http://ip-api.com/batch",a.map(t=>({query:t,fields:"lat,lon,country,countryCode,city,query"})),{timeout:3e3})).data.forEach(t=>{t.lat&&t.lon&&c.set(t.query,{lat:t.lat,lon:t.lon,country:t.country,countryCode:t.countryCode,city:t.city})})}}catch(t){}e.forEach(t=>{if(!c.has(t)){let e=n.default.lookup(t);e?c.set(t,{lat:e.ll[0],lon:e.ll[1],country:new Intl.DisplayNames(["en"],{type:"region"}).of(e.country)||e.country,countryCode:e.country,city:e.city||"Unknown Node"}):c.set(t,{lat:0,lon:0,country:"Private Network",countryCode:"XX",city:"Hidden"})}})}}async function d(){let[t,e]=await Promise.all([i(),s()]);if(!t||0===t.length)throw Error("Network Unreachable");let a=new Map,r=new Map,n=[],o=[];Array.isArray(e.mainnet)&&e.mainnet.forEach(t=>{let e=parseFloat(t.credits||t.amount||"0"),r=t.pod_id||t.pubkey||t.node;r&&!isNaN(e)&&(a.set(r,e),n.push(e))}),Array.isArray(e.devnet)&&e.devnet.forEach(t=>{let e=parseFloat(t.credits||t.amount||"0"),a=t.pod_id||t.pubkey||t.node;a&&!isNaN(e)&&(r.set(a,e),o.push(e))}),n.sort((t,e)=>t-e),o.sort((t,e)=>t-e);let d=n.length?n[Math.floor(n.length/2)]:0,u=o.length?o[Math.floor(o.length/2)]:0,y=t.map(t=>Number(t.storage_committed)||0).sort((t,e)=>t-e),m=y.length?y[Math.floor(y.length/2)]:1,f={},g=new Set;t.forEach(t=>{let e=t.version||"0.0.0",a=h(e);f[e]=(f[e]||0)+1,g.add(a)});let w=Object.keys(f).sort((t,e)=>f[e]-f[t])[0]||"0.0.0",k=Array.from(g).sort((t,e)=>p(e,t));await l([...new Set(t.map(t=>t.address.split(":")[0]))]);let v=[],N=(t,e,a,r,n)=>{let o=t.address.split(":")[0],i=c.get(o)||{lat:0,lon:0,country:"Unknown",countryCode:"XX",city:"Unknown"},s=Number(t.storage_committed)||0,l=Number(t.storage_used)||0,d=Number(t.uptime)||0,u=((t,e,a,r,n,o,i,s,l)=>{if(t<=0)return{total:0,breakdown:{uptime:0,version:0,reputation:0,storage:0}};let d=a/86400,u=100/(1+Math.exp(-.2*(d-7)));d<1&&(u=Math.min(u,20));let c=((t,e,a=100)=>0===e?t>0?a:0:Math.min(a,a/2*Math.log2(t/e+1)))(t,l,100),y=e>0?Math.min(15,5*Math.log2(e/0x40000000+2)):0,m=c+y,f=((t,e,a)=>{let r=h(t),n=h(e);if(p(r,n)>=0)return 100;let o=a.indexOf(n),i=a.indexOf(r);if(-1===i)return 0;let s=i-o;return s<=0?100:1===s?90:2===s?70:3===s?50:4===s?30:5===s?10:Math.max(0,10-(s-5))})(r,n,o),g=0,w=null;return null!==s&&i>0?(w=Math.min(100,s/(2*i)*100),g=Math.round(.35*u+.3*m+.2*w+.15*f)):(g=Math.round(.45*u+.35*m+.2*f),w=null),{total:Math.max(0,Math.min(100,g)),breakdown:{uptime:Math.round(u),version:Math.round(f),reputation:w,storage:Math.round(m)}}})(s,l,d,t.version||"0.0.0",w,k,r,a,m);return{...t,pubkey:t.pubkey||t.public_key,network:e,storage_committed:s,storage_used:l,credits:a,isUntracked:n,health:u.total,healthBreakdown:u.breakdown,location:{lat:i.lat,lon:i.lon,countryName:i.country,countryCode:i.countryCode,city:i.city}}};t.forEach(t=>{let n=t.pubkey||t.public_key,o=a.has(n),i=r.has(n);if(o){let e=a.get(n)||0;v.push(N(t,"MAINNET",e,d,!1))}if(i){let e=r.get(n)||0;v.push(N(t,"DEVNET",e,u,!1))}if(!o&&!i){let a=e.mainnet.length>0;v.push(N(t,"UNKNOWN",null,d,a))}});let M=v.filter(t=>"MAINNET"===t.network).sort((t,e)=>(e.credits||0)-(t.credits||0)),x=v.filter(t=>"DEVNET"===t.network).sort((t,e)=>(e.credits||0)-(t.credits||0)),E=v.filter(t=>"UNKNOWN"===t.network),b=1;M.forEach((t,e)=>{e>0&&(t.credits||0)<(M[e-1].credits||0)&&(b=e+1),t.rank=b}),b=1,x.forEach((t,e)=>{e>0&&(t.credits||0)<(x[e-1].credits||0)&&(b=e+1),t.rank=b});let A=[...M,...x,...E],P=[...A].sort((t,e)=>e.health-t.health),S=1;P.forEach((t,e)=>{e>0&&t.health<P[e-1].health&&(S=e+1),t.health_rank=S});let _=0,C=0,R=0,q=0,U=0;A.forEach(t=>{_+=t.healthBreakdown.uptime,C+=t.healthBreakdown.version,U+=t.healthBreakdown.storage,null!==t.healthBreakdown.reputation&&(R+=t.healthBreakdown.reputation,q++)});let B=A.length||1,$=Math.round(A.reduce((t,e)=>t+e.health,0)/B);return{nodes:A,stats:{consensusVersion:w,medianCredits:d,medianStorage:m,totalNodes:A.length,systemStatus:{credits:e.mainnet.length>0||e.devnet.length>0,rpc:!0},avgBreakdown:{total:$,uptime:Math.round(_/B),version:Math.round(C/B),reputation:q>0?Math.round(R/q):null,storage:Math.round(U/B)}}}}t.s(["getNetworkPulse",()=>d]),a()}catch(t){a(t)}},!1),35697,t=>t.a(async(e,a)=>{try{var r=t.i(83950),n=e([r]);async function o(t,e){e.setHeader("Cache-Control","no-store, no-cache, must-revalidate, proxy-revalidate"),e.setHeader("Pragma","no-cache"),e.setHeader("Expires","0");try{let{nodes:t,stats:a}=await (0,r.getNetworkPulse)();e.status(200).json({result:{pods:t},stats:a})}catch(t){console.error("Stats API Fatal Error:",t),e.status(503).json({error:"Pulse System Offline",details:String(t),stats:{totalNodes:0,systemStatus:{rpc:!1,credits:!1}}})}}[r]=n.then?(await n)():n,t.s(["default",()=>o]),a()}catch(t){a(t)}},!1),72988,t=>t.a(async(e,a)=>{try{var r=t.i(26747),n=t.i(90406),o=t.i(44898),i=t.i(62950),s=t.i(35697),l=t.i(7031),d=t.i(81927),u=t.i(46432),c=e([s]);[s]=c.then?(await c)():c;let p=(0,i.hoist)(s,"default"),y=(0,i.hoist)(s,"config"),m=new o.PagesAPIRouteModule({definition:{kind:n.RouteKind.PAGES_API,page:"/api/stats",pathname:"/api/stats",bundlePath:"",filename:""},userland:s,distDir:".next",relativeProjectDir:""});async function h(t,e,a){m.isDev&&(0,u.addRequestMeta)(t,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/stats";n=n.replace(/\/index$/,"")||"/";let o=await m.prepare(t,e,{srcPage:n});if(!o){e.statusCode=400,e.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve());return}let{query:i,params:s,prerenderManifest:c,routerServerContext:h}=o;try{let a=t.method||"GET",r=(0,l.getTracer)(),o=r.getActiveScopeSpan(),u=m.instrumentationOnRequestError.bind(m),p=async o=>m.render(t,e,{query:{...i,...s},params:s,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:c.preview,propagateError:!1,dev:m.isDev,page:"/api/stats",internalRevalidate:null==h?void 0:h.revalidate,onError:(...e)=>u(t,...e)}).finally(()=>{if(!o)return;o.setAttributes({"http.status_code":e.statusCode,"next.rsc":!1});let t=r.getRootSpanAttributes();if(!t)return;if(t.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${t.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=t.get("next.route");if(i){let t=`${a} ${i}`;o.setAttributes({"next.route":i,"http.route":i,"next.span_name":t}),o.updateName(t)}else o.updateName(`${a} ${n}`)});o?await p(o):await r.withPropagatedContext(t.headers,()=>r.trace(d.BaseServerSpan.handleRequest,{spanName:`${a} ${n}`,kind:l.SpanKind.SERVER,attributes:{"http.method":a,"http.target":t.url}},p))}catch(t){if(m.isDev)throw t;(0,r.sendError)(e,500,"Internal Server Error")}finally{null==a.waitUntil||a.waitUntil.call(a,Promise.resolve())}}t.s(["config",0,y,"default",0,p,"handler",()=>h]),a()}catch(t){a(t)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__09e935a2._.js.map