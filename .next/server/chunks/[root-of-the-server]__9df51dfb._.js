module.exports=[70406,(t,e,a)=>{e.exports=t.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},12967,t=>t.a(async(e,a)=>{try{let e=await t.y("axios");t.n(e),a()}catch(t){a(t)}},!0),18692,(t,e,a)=>{e.exports=t.x("geoip-lite",()=>require("geoip-lite"))},83950,t=>t.a(async(e,a)=>{try{var r=t.i(12967),o=t.i(18692),s=e([r]);[r]=s.then?(await s)():s;let u=["173.212.203.145","161.97.97.41","192.190.136.36","192.190.136.38","207.244.255.1","192.190.136.28","192.190.136.29"],c=new Map,h=t=>t?t.split("-")[0].replace(/[^0-9.]/g,""):"0.0.0",p=(t,e)=>{let a=h(t).split(".").map(Number),r=h(e).split(".").map(Number);for(let t=0;t<Math.max(a.length,r.length);t++){let e=a[t]||0,o=r[t]||0;if(e>o)return 1;if(e<o)return -1}return 0},m={timeout:8e3,headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"application/json, text/plain, */*"}};async function n(){let t={jsonrpc:"2.0",method:"get-pods-with-stats",params:[],id:1};try{let e=await r.default.post(`http://${u[0]}:6000/rpc`,t,{timeout:4e3});if(e.data?.result?.pods)return e.data.result.pods}catch(t){}let e=u.slice(1).sort(()=>.5-Math.random()).slice(0,3);try{return await Promise.any(e.map(e=>r.default.post(`http://${e}:6000/rpc`,t,{timeout:4e3}).then(t=>t.data?.result?.pods||[])))}catch(t){return[]}}async function l(){let[t,e]=await Promise.allSettled([r.default.get("https://podcredits.xandeum.network/api/mainnet-pod-credits",m),r.default.get("https://podcredits.xandeum.network/api/pods-credits",m)]),a=t=>{if("fulfilled"!==t.status)return[];let e=t.value.data;return e?.pods_credits&&Array.isArray(e.pods_credits)?e.pods_credits:Array.isArray(e)?e:[]};return{mainnet:a(t),devnet:a(e)}}async function i(t){let e=t.filter(t=>!c.has(t));if(e.length>0){try{for(let t=0;t<e.length;t+=100){let a=e.slice(t,t+100);(await r.default.post("http://ip-api.com/batch",a.map(t=>({query:t,fields:"lat,lon,country,countryCode,city,query"})),{timeout:3e3})).data.forEach(t=>{t.lat&&t.lon&&c.set(t.query,{lat:t.lat,lon:t.lon,country:t.country,countryCode:t.countryCode,city:t.city})})}}catch(t){}e.forEach(t=>{if(!c.has(t)){let e=o.default.lookup(t);e?c.set(t,{lat:e.ll[0],lon:e.ll[1],country:new Intl.DisplayNames(["en"],{type:"region"}).of(e.country)||e.country,countryCode:e.country,city:e.city||"Unknown Node"}):c.set(t,{lat:0,lon:0,country:"Private Network",countryCode:"XX",city:"Hidden"})}})}}async function d(){let[t,e]=await Promise.all([n(),l()]);if(!t||0===t.length)throw Error("Network Unreachable");let a=new Map,r=new Map,o=[],s=[];Array.isArray(e.mainnet)&&e.mainnet.forEach(t=>{let e=parseFloat(t.credits||t.amount||"0"),r=t.pod_id||t.pubkey||t.node;r&&!isNaN(e)&&(a.set(r,e),o.push(e))}),Array.isArray(e.devnet)&&e.devnet.forEach(t=>{let e=parseFloat(t.credits||t.amount||"0"),a=t.pod_id||t.pubkey||t.node;a&&!isNaN(e)&&(r.set(a,e),s.push(e))}),o.sort((t,e)=>t-e),s.sort((t,e)=>t-e);let d=o.length?o[Math.floor(o.length/2)]:0,u=s.length?s[Math.floor(s.length/2)]:0,m=t.map(t=>Number(t.storage_committed)||0).sort((t,e)=>t-e),y=m.length?m[Math.floor(m.length/2)]:1,g={},f=new Set;t.forEach(t=>{let e=t.version||"0.0.0",a=h(e);g[e]=(g[e]||0)+1,f.add(a)});let N=Object.keys(g).sort((t,e)=>g[e]-g[t])[0]||"0.0.0",b=Array.from(f).sort((t,e)=>p(e,t));await i([...new Set(t.map(t=>t.address.split(":")[0]))]);let k=[],w=(t,e,a,r,o)=>{let s=t.address.split(":")[0],n=c.get(s)||{lat:0,lon:0,country:"Unknown",countryCode:"XX",city:"Unknown"},l=Number(t.storage_committed)||0,i=Number(t.storage_used)||0,d=Number(t.uptime)||0,u=((t,e,a,r,o,s,n,l,i)=>{if(t<=0)return{total:0,breakdown:{uptime:0,version:0,reputation:0,storage:0}};let d=a/86400,u=100/(1+Math.exp(-.2*(d-7)));d<1&&(u=Math.min(u,20));let c=((t,e,a=100)=>0===e?t>0?a:0:Math.min(a,a/2*Math.log2(t/e+1)))(t,i,100),m=e>0?Math.min(15,5*Math.log2(e/0x40000000+2)):0,y=c+m,g=((t,e,a)=>{let r=h(t),o=h(e);if(p(r,o)>=0)return 100;let s=a.indexOf(o),n=a.indexOf(r);if(-1===n)return 0;let l=n-s;return l<=0?100:1===l?90:2===l?70:3===l?50:4===l?30:5===l?10:Math.max(0,10-(l-5))})(r,o,s),f=0,N=null;return null!==l&&n>0?(N=Math.min(100,l/(2*n)*100),f=Math.round(.35*u+.3*y+.2*N+.15*g)):(f=Math.round(.45*u+.35*y+.2*g),N=null),{total:Math.max(0,Math.min(100,f)),breakdown:{uptime:Math.round(u),version:Math.round(g),reputation:N,storage:Math.round(y)}}})(l,i,d,t.version||"0.0.0",N,b,r,a,y);return{...t,pubkey:t.pubkey||t.public_key,network:e,storage_committed:l,storage_used:i,credits:a,isUntracked:o,health:u.total,healthBreakdown:u.breakdown,location:{lat:n.lat,lon:n.lon,countryName:n.country,countryCode:n.countryCode,city:n.city}}};t.forEach(t=>{let o=t.pubkey||t.public_key,s=a.has(o),n=r.has(o);if(s){let e=a.get(o)||0;k.push(w(t,"MAINNET",e,d,!1))}if(n){let e=r.get(o)||0;k.push(w(t,"DEVNET",e,u,!1))}if(!s&&!n){let a=e.mainnet.length>0;k.push(w(t,"UNKNOWN",null,d,a))}});let v=k.filter(t=>"MAINNET"===t.network).sort((t,e)=>(e.credits||0)-(t.credits||0)),M=k.filter(t=>"DEVNET"===t.network).sort((t,e)=>(e.credits||0)-(t.credits||0)),x=k.filter(t=>"UNKNOWN"===t.network),E=1;v.forEach((t,e)=>{e>0&&(t.credits||0)<(v[e-1].credits||0)&&(E=e+1),t.rank=E}),E=1,M.forEach((t,e)=>{e>0&&(t.credits||0)<(M[e-1].credits||0)&&(E=e+1),t.rank=E});let S=[...v,...M,...x],C=[...S].sort((t,e)=>e.health-t.health),P=1;C.forEach((t,e)=>{e>0&&t.health<C[e-1].health&&(P=e+1),t.health_rank=P});let A=0,U=0,_=0,V=0,R=0;S.forEach(t=>{A+=t.healthBreakdown.uptime,U+=t.healthBreakdown.version,R+=t.healthBreakdown.storage,null!==t.healthBreakdown.reputation&&(_+=t.healthBreakdown.reputation,V++)});let D=S.length||1,q=Math.round(S.reduce((t,e)=>t+e.health,0)/D);return{nodes:S,stats:{consensusVersion:N,medianCredits:d,medianStorage:y,totalNodes:S.length,systemStatus:{credits:e.mainnet.length>0||e.devnet.length>0,rpc:!0},avgBreakdown:{total:q,uptime:Math.round(A/D),version:Math.round(U/D),reputation:V>0?Math.round(_/V):null,storage:Math.round(R/D)}}}}t.s(["getNetworkPulse",()=>d]),a()}catch(t){a(t)}},!1),70197,t=>t.a(async(e,a)=>{try{var r=t.i(83950),o=e([r]);async function s(t,e){e.setHeader("Cache-Control","no-store, no-cache, must-revalidate, proxy-revalidate");try{let{nodes:t,stats:a}=await (0,r.getNetworkPulse)(),o=new Map;t.forEach(t=>{let{city:e,countryName:a,countryCode:r,lat:s,lon:n}=t.location;if(0===s&&0===n)return;let l=`${e}-${a}`,i=(t.storage_committed||0)/0x40000000,d=t.network||"UNKNOWN",u=null!==t.credits;if(o.has(l)){let e=o.get(l);e.count++,e.totalStorage+=i,u&&(e.totalCredits+=t.credits,e.hasValidCreditData=!0),e.healthSum+=t.health,e.totalUptime+=t.uptime||0,t.is_public&&e.publicCount++,e.ips.push(t.address.split(":")[0]),i>e.bestNodes.storageVal&&(e.bestNodes.storageVal=i,e.bestNodes.storagePk=t.pubkey,e.bestNodes.storageNet=d),u&&(t.credits||0)>=e.bestNodes.creditsVal&&(e.bestNodes.creditsVal=t.credits,e.bestNodes.creditsPk=t.pubkey,e.bestNodes.creditsNet=d,e.bestNodes.creditsUntracked=!1),t.health>e.bestNodes.healthVal&&(e.bestNodes.healthVal=t.health,e.bestNodes.healthPk=t.pubkey,e.bestNodes.healthUptime=t.uptime||0,e.bestNodes.healthNet=d)}else o.set(l,{name:e,country:a,countryCode:r,lat:s,lon:n,count:1,totalStorage:i,totalCredits:t.credits||0,hasValidCreditData:u,healthSum:t.health,totalUptime:t.uptime||0,publicCount:+!!t.is_public,ips:[t.address.split(":")[0]],bestNodes:{storageVal:i,storagePk:t.pubkey,storageNet:d,creditsVal:t.credits||0,creditsPk:t.pubkey,creditsNet:d,creditsUntracked:!u,healthVal:t.health,healthPk:t.pubkey,healthUptime:t.uptime||0,healthNet:d}})});let s=Array.from(o.values()).map(t=>{let e=t.hasValidCreditData?t.totalCredits:null;return{name:t.name,country:t.country,countryCode:t.countryCode,lat:t.lat,lon:t.lon,count:t.count,totalStorage:t.totalStorage,totalCredits:e,avgHealth:Math.round(t.healthSum/t.count),avgUptime:t.totalUptime/t.count,publicRatio:t.publicCount/t.count*100,ips:t.ips,topPerformers:{STORAGE:{pk:t.bestNodes.storagePk,val:t.bestNodes.storageVal,network:t.bestNodes.storageNet},CREDITS:{pk:t.bestNodes.creditsPk,val:t.bestNodes.creditsVal,network:t.bestNodes.creditsNet,isUntracked:t.bestNodes.creditsUntracked},HEALTH:{pk:t.bestNodes.healthPk,val:t.bestNodes.healthVal,subVal:t.bestNodes.healthUptime,network:t.bestNodes.healthNet}}}}),n=[...s].sort((t,e)=>e.totalStorage-t.totalStorage)[0];e.status(200).json({locations:s,stats:{totalNodes:a.totalNodes,countries:new Set(s.map(t=>t.country)).size,topRegion:n?n.name:"Global",topRegionMetric:n?n.totalStorage:0}})}catch(t){e.status(500).json({error:"Geo System Offline"})}}[r]=o.then?(await o)():o,t.s(["default",()=>s]),a()}catch(t){a(t)}},!1),54446,t=>t.a(async(e,a)=>{try{var r=t.i(26747),o=t.i(90406),s=t.i(44898),n=t.i(62950),l=t.i(70197),i=t.i(7031),d=t.i(81927),u=t.i(46432),c=e([l]);[l]=c.then?(await c)():c;let p=(0,n.hoist)(l,"default"),m=(0,n.hoist)(l,"config"),y=new s.PagesAPIRouteModule({definition:{kind:o.RouteKind.PAGES_API,page:"/api/geo",pathname:"/api/geo",bundlePath:"",filename:""},userland:l,distDir:".next",relativeProjectDir:""});async function h(t,e,a){y.isDev&&(0,u.addRequestMeta)(t,"devRequestTimingInternalsEnd",process.hrtime.bigint());let o="/api/geo";o=o.replace(/\/index$/,"")||"/";let s=await y.prepare(t,e,{srcPage:o});if(!s){e.statusCode=400,e.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve());return}let{query:n,params:l,prerenderManifest:c,routerServerContext:h}=s;try{let a=t.method||"GET",r=(0,i.getTracer)(),s=r.getActiveScopeSpan(),u=y.instrumentationOnRequestError.bind(y),p=async s=>y.render(t,e,{query:{...n,...l},params:l,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:c.preview,propagateError:!1,dev:y.isDev,page:"/api/geo",internalRevalidate:null==h?void 0:h.revalidate,onError:(...e)=>u(t,...e)}).finally(()=>{if(!s)return;s.setAttributes({"http.status_code":e.statusCode,"next.rsc":!1});let t=r.getRootSpanAttributes();if(!t)return;if(t.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${t.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=t.get("next.route");if(n){let t=`${a} ${n}`;s.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),s.updateName(t)}else s.updateName(`${a} ${o}`)});s?await p(s):await r.withPropagatedContext(t.headers,()=>r.trace(d.BaseServerSpan.handleRequest,{spanName:`${a} ${o}`,kind:i.SpanKind.SERVER,attributes:{"http.method":a,"http.target":t.url}},p))}catch(t){if(y.isDev)throw t;(0,r.sendError)(e,500,"Internal Server Error")}finally{null==a.waitUntil||a.waitUntil.call(a,Promise.resolve())}}t.s(["config",0,m,"default",0,p,"handler",()=>h]),a()}catch(t){a(t)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__9df51dfb._.js.map